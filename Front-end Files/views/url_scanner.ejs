<%- include('partials/header', { title: 'URL Scanner - SecureGuard' }) %>
<%- include('partials/sidebar', { page: 'url-scanner' }) %>

<div class="main-content">
    <div class="container">
        <div class="fade-in-left">
            <h1 class="text-gradient-emerald">üîç Malicious URL Scanner</h1>
            <p style="color: #64748B; margin-top: 0.5rem;">Scan URLs for phishing, malware, and suspicious activity</p>
        </div>

        <div class="glass-card card-emerald fade-in-up" style="margin-top: 2rem;">
            <form id="urlScanForm">
                <div class="form-group">
                    <label class="form-label" for="url">Enter URL to Scan</label>
                    <input type="url" id="url" name="url" class="form-input" placeholder="https://example.com" required>
                </div>
                <button type="submit" class="btn btn-primary">Scan URL</button>
            </form>
        </div>

        <div id="scanResults" style="display: none;" class="glass-card fade-in-up" style="margin-top: 2rem;">
            <h3 style="color: var(--light-emerald); margin-bottom: 1.5rem;">Scan Results</h3>
            <div id="resultsContent"></div>
        </div>
    </div>
</div>

<script>
document.getElementById('urlScanForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const url = document.getElementById('url').value;
    const resultsDiv = document.getElementById('scanResults');
    const resultsContent = document.getElementById('resultsContent');
    
    resultsContent.innerHTML = '<div class="loading">Scanning URL...</div>';
    resultsDiv.style.display = 'block';
    
    try {
        const response = await fetch('/api/scan-url', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ url })
        });
        
        const data = await response.json();
        
        resultsContent.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                <div class="stat-card">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">${data.safe ? '‚úÖ' : '‚ö†Ô∏è'}</div>
                    <div class="stat-label">Status</div>
                    <div style="color: ${data.safe ? 'var(--light-emerald)' : '#FCA5A5'}; font-weight: 600; margin-top: 0.5rem;">
                        ${data.safe ? 'Safe' : 'Suspicious'}
                    </div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">üõ°Ô∏è</div>
                    <div class="stat-label">Risk Score</div>
                    <div style="color: var(--light-gold); font-weight: 600; margin-top: 0.5rem;">${data.riskScore}/100</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">üåê</div>
                    <div class="stat-label">Domain Age</div>
                    <div style="color: #94A3B8; font-weight: 600; margin-top: 0.5rem;">${data.domainAge} days</div>
                </div>
            </div>
            <div style="background: rgba(30, 41, 59, 0.5); padding: 1.5rem; border-radius: 12px; border-left: 4px solid ${data.safe ? 'var(--primary-emerald)' : '#EF4444'};">
                <h4 style="color: var(--light-emerald); margin-bottom: 1rem;">Threat Analysis</h4>
                <ul style="color: #CBD5E1; line-height: 1.8;">
                    ${data.threats.map(t => `<li>${t}</li>`).join('')}
                </ul>
            </div>
        `;
    } catch (error) {
        resultsContent.innerHTML = '<div class="alert alert-error">Error scanning URL. Please try again.</div>';
    }
});
</script>

<%- include('partials/footer') %>